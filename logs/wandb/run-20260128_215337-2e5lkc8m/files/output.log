Config saved: logs/D4RL/pointmaze/umaze-v2/config.json

Loading dataset...
Dataset size: 628444
Observation dim: 8
Action dim: 2
Transition dim: 10

Creating model...
Model parameters: 15,864,074
Model config: {'dim': 128, 'dim_mults': [1, 2, 4], 'n_timesteps': 100, 'beta_schedule': 'cosine', 'horizon': 32}

Loss components: ['diffusion']

Starting training...
Epoch 1/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:23<00:00,  9.33it/s, diffusion=0.0599, lr=5.99e-04]


Epoch 1 Summary:
  Diffusion loss: 0.0888
Epoch 2/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0535, lr=5.98e-04]

Epoch 2 Summary:
  Diffusion loss: 0.0546
Epoch 3/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0498, lr=5.95e-04]

Epoch 3 Summary:
  Diffusion loss: 0.0519
Epoch 4/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0600, lr=5.91e-04]

Epoch 4 Summary:
  Diffusion loss: 0.0505
Epoch 5/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.19it/s, diffusion=0.0485, lr=5.85e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_10000.pt

Epoch 5 Summary:
  Diffusion loss: 0.0493
Epoch 6/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0481, lr=5.79e-04]

Epoch 6 Summary:
  Diffusion loss: 0.0487
Epoch 7/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0463, lr=5.71e-04]

Epoch 7 Summary:
  Diffusion loss: 0.0480
Epoch 8/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0492, lr=5.63e-04]

Epoch 8 Summary:
  Diffusion loss: 0.0476
Epoch 9/50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.19it/s, diffusion=0.0452, lr=5.53e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_20000.pt

Epoch 9 Summary:
  Diffusion loss: 0.0472
Epoch 10/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0461, lr=5.43e-04]

Epoch 10 Summary:
  Diffusion loss: 0.0469
Epoch 11/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0455, lr=5.31e-04]

Epoch 11 Summary:
  Diffusion loss: 0.0466
Epoch 12/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0427, lr=5.19e-04]

Epoch 12 Summary:
  Diffusion loss: 0.0464
Epoch 13/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0457, lr=5.05e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_30000.pt

Epoch 13 Summary:
  Diffusion loss: 0.0462
Epoch 14/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0432, lr=4.91e-04]

Epoch 14 Summary:
  Diffusion loss: 0.0460
Epoch 15/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0467, lr=4.76e-04]

Epoch 15 Summary:
  Diffusion loss: 0.0459
Epoch 16/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0455, lr=4.61e-04]

Epoch 16 Summary:
  Diffusion loss: 0.0456
Epoch 17/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:27<00:00,  9.19it/s, diffusion=0.0450, lr=4.45e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_40000.pt

Epoch 17 Summary:
  Diffusion loss: 0.0454
Epoch 18/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0436, lr=4.28e-04]

Epoch 18 Summary:
  Diffusion loss: 0.0454
Epoch 19/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0470, lr=4.10e-04]

Epoch 19 Summary:
  Diffusion loss: 0.0452
Epoch 20/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0466, lr=3.93e-04]

Epoch 20 Summary:
  Diffusion loss: 0.0452
Epoch 21/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0462, lr=3.75e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_50000.pt

Epoch 21 Summary:
  Diffusion loss: 0.0449
Epoch 22/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0461, lr=3.56e-04]

Epoch 22 Summary:
  Diffusion loss: 0.0448
Epoch 23/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0465, lr=3.38e-04]

Epoch 23 Summary:
  Diffusion loss: 0.0447
Epoch 24/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0429, lr=3.19e-04]

Epoch 24 Summary:
  Diffusion loss: 0.0446
Epoch 25/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0487, lr=3.00e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_60000.pt

Epoch 25 Summary:
  Diffusion loss: 0.0444
Epoch 26/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0440, lr=2.81e-04]

Epoch 26 Summary:
  Diffusion loss: 0.0444
Epoch 27/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0407, lr=2.62e-04]

Epoch 27 Summary:
  Diffusion loss: 0.0443
Epoch 28/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0423, lr=2.44e-04]

Epoch 28 Summary:
  Diffusion loss: 0.0442
Epoch 29/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.19it/s, diffusion=0.0410, lr=2.25e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_70000.pt

Epoch 29 Summary:
  Diffusion loss: 0.0440
Epoch 30/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0422, lr=2.07e-04]

Epoch 30 Summary:
  Diffusion loss: 0.0440
Epoch 31/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0438, lr=1.90e-04]

Epoch 31 Summary:
  Diffusion loss: 0.0439
Epoch 32/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0459, lr=1.72e-04]

Epoch 32 Summary:
  Diffusion loss: 0.0438
Epoch 33/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0414, lr=1.55e-04]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_80000.pt

Epoch 33 Summary:
  Diffusion loss: 0.0437
Epoch 34/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0417, lr=1.39e-04]

Epoch 34 Summary:
  Diffusion loss: 0.0436
Epoch 35/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0414, lr=1.24e-04]

Epoch 35 Summary:
  Diffusion loss: 0.0435
Epoch 36/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0439, lr=1.09e-04]

Epoch 36 Summary:
  Diffusion loss: 0.0435
Epoch 37/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0452, lr=9.46e-05]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_90000.pt

Epoch 37 Summary:
  Diffusion loss: 0.0434
Epoch 38/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0413, lr=8.13e-05]

Epoch 38 Summary:
  Diffusion loss: 0.0434
Epoch 39/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0461, lr=6.88e-05]

Epoch 39 Summary:
  Diffusion loss: 0.0432
Epoch 40/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0410, lr=5.73e-05]

Epoch 40 Summary:
  Diffusion loss: 0.0433
Epoch 41/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.19it/s, diffusion=0.0448, lr=4.67e-05]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_100000.pt

Epoch 41 Summary:
  Diffusion loss: 0.0432
Epoch 42/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0469, lr=3.71e-05]

Epoch 42 Summary:
  Diffusion loss: 0.0431
Epoch 43/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0465, lr=2.86e-05]

Epoch 43 Summary:
  Diffusion loss: 0.0431
Epoch 44/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.21it/s, diffusion=0.0438, lr=2.11e-05]

Epoch 44 Summary:
  Diffusion loss: 0.0431
Epoch 45/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0457, lr=1.47e-05]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_110000.pt

Epoch 45 Summary:
  Diffusion loss: 0.0431
Epoch 46/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0394, lr=9.43e-06]

Epoch 46 Summary:
  Diffusion loss: 0.0431
Epoch 47/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0471, lr=5.31e-06]

Epoch 47 Summary:
  Diffusion loss: 0.0430
Epoch 48/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0454, lr=2.37e-06]

Epoch 48 Summary:
  Diffusion loss: 0.0430
Epoch 49/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.20it/s, diffusion=0.0394, lr=5.92e-07]

✓ Saved checkpoint: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_120000.pt

Epoch 49 Summary:
  Diffusion loss: 0.0430
Epoch 50/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 2454/2454 [04:26<00:00,  9.22it/s, diffusion=0.0446, lr=0.00e+00]

Epoch 50 Summary:
  Diffusion loss: 0.0430

✓ Final checkpoint saved: logs/D4RL/pointmaze/umaze-v2/checkpoint_step_122700.pt
Traceback (most recent call last):
  File "/home/pijet/pointmaze_with_diffusion/scripts/train.py", line 493, in <module>
    main()
  File "/home/pijet/pointmaze_with_diffusion/scripts/train.py", line 468, in main
    for epoch, metrics in trainer.train(args.n_epochs, start_epoch=start_epoch, yield_metrics=True):
TypeError: 'NoneType' object is not iterable
Traceback (most recent call last):
  File "/home/pijet/pointmaze_with_diffusion/scripts/train.py", line 493, in <module>
    main()
  File "/home/pijet/pointmaze_with_diffusion/scripts/train.py", line 468, in main
    for epoch, metrics in trainer.train(args.n_epochs, start_epoch=start_epoch, yield_metrics=True):
TypeError: 'NoneType' object is not iterable
